'use client';

import React, { useState, useMemo } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { ScrollArea } from '@/components/ui/scroll-area';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import {
  Search,
  Smile,
  Heart,
  Zap,
  Coffee,
  Car,
  Gamepad2,
  Flag,
  Clock,
  Star,
} from 'lucide-react';
import { cn } from '@/lib/utils';
import { Icon } from '@radix-ui/react-select';

interface EmojiPickerProps {
  onEmojiSelect: (emoji: string) => void;
  className?: string;
}

interface EmojiCategory {
  id: string;
  name: string;
  icon: React.ComponentType<any>;
  emojis: string[];
}

const EMOJI_CATEGORIES: EmojiCategory[] = [
  {
    id: 'recent',
    name: 'Recent',
    icon: Clock,
    emojis: [], // Will be populated from localStorage
  },
  {
    id: 'smileys',
    name: 'Smileys & People',
    icon: Smile,
    emojis: [
      'ðŸ˜€',
      'ðŸ˜ƒ',
      'ðŸ˜„',
      'ðŸ˜',
      'ðŸ˜†',
      'ðŸ˜…',
      'ðŸ¤£',
      'ðŸ˜‚',
      'ðŸ™‚',
      'ðŸ™ƒ',
      'ðŸ˜‰',
      'ðŸ˜Š',
      'ðŸ˜‡',
      'ðŸ¥°',
      'ðŸ˜',
      'ðŸ¤©',
      'ðŸ˜˜',
      'ðŸ˜—',
      'ðŸ˜š',
      'ðŸ˜™',
      'ðŸ˜‹',
      'ðŸ˜›',
      'ðŸ˜œ',
      'ðŸ¤ª',
      'ðŸ˜',
      'ðŸ¤‘',
      'ðŸ¤—',
      'ðŸ¤­',
      'ðŸ¤«',
      'ðŸ¤”',
      'ðŸ¤',
      'ðŸ¤¨',
      'ðŸ˜',
      'ðŸ˜‘',
      'ðŸ˜¶',
      'ðŸ˜',
      'ðŸ˜’',
      'ðŸ™„',
      'ðŸ˜¬',
      'ðŸ¤¥',
      'ðŸ˜”',
      'ðŸ˜ª',
      'ðŸ¤¤',
      'ðŸ˜´',
      'ðŸ˜·',
      'ðŸ¤’',
      'ðŸ¤•',
      'ðŸ¤¢',
      'ðŸ¤®',
      'ðŸ¤§',
      'ðŸ¥µ',
      'ðŸ¥¶',
      'ðŸ¥´',
      'ðŸ˜µ',
      'ðŸ¤¯',
      'ðŸ¤ ',
      'ðŸ¥³',
      'ðŸ˜Ž',
      'ðŸ¤“',
      'ðŸ§',
      'ðŸ˜•',
      'ðŸ˜Ÿ',
      'ðŸ™',
      'â˜¹ï¸',
      'ðŸ˜®',
      'ðŸ˜¯',
      'ðŸ˜²',
      'ðŸ˜³',
      'ðŸ¥º',
      'ðŸ˜¦',
      'ðŸ˜§',
      'ðŸ˜¨',
      'ðŸ˜°',
      'ðŸ˜¥',
      'ðŸ˜¢',
      'ðŸ˜­',
      'ðŸ˜±',
      'ðŸ˜–',
      'ðŸ˜£',
      'ðŸ˜ž',
      'ðŸ˜“',
      'ðŸ˜©',
      'ðŸ˜«',
      'ðŸ¥±',
      'ðŸ˜¤',
      'ðŸ˜¡',
      'ðŸ˜ ',
      'ðŸ¤¬',
      'ðŸ˜ˆ',
      'ðŸ‘¿',
      'ðŸ‘¹',
      'ðŸ‘º',
      'ðŸ¤¡',
      'ðŸ’©',
      'ðŸ‘»',
      'ðŸ’€',
      'â˜ ï¸',
      'ðŸ‘½',
      'ðŸ‘¾',
      'ðŸ¤–',
      'ðŸŽƒ',
      'ðŸ˜º',
      'ðŸ˜¸',
      'ðŸ˜¹',
      'ðŸ˜»',
      'ðŸ˜¼',
      'ðŸ˜½',
      'ðŸ™€',
      'ðŸ˜¿',
      'ðŸ˜¾',
    ],
  },
  {
    id: 'animals',
    name: 'Animals & Nature',
    icon: Heart,
    emojis: [
      'ðŸ¶',
      'ðŸ±',
      'ðŸ­',
      'ðŸ¹',
      'ðŸ°',
      'ðŸ¦Š',
      'ðŸ»',
      'ðŸ¼',
      'ðŸ¨',
      'ðŸ¯',
      'ðŸ¦',
      'ðŸ®',
      'ðŸ·',
      'ðŸ½',
      'ðŸ¸',
      'ðŸµ',
      'ðŸ™ˆ',
      'ðŸ™‰',
      'ðŸ™Š',
      'ðŸ’',
      'ðŸ”',
      'ðŸ§',
      'ðŸ¦',
      'ðŸ¤',
      'ðŸ£',
      'ðŸ¥',
      'ðŸ¦†',
      'ðŸ¦…',
      'ðŸ¦‰',
      'ðŸ¦‡',
      'ðŸº',
      'ðŸ—',
      'ðŸ´',
      'ðŸ¦„',
      'ðŸ',
      'ðŸ›',
      'ðŸ¦‹',
      'ðŸŒ',
      'ðŸž',
      'ðŸœ',
      'ðŸ¦Ÿ',
      'ðŸ¦—',
      'ðŸ•·ï¸',
      'ðŸ•¸ï¸',
      'ðŸ¦‚',
      'ðŸ¢',
      'ðŸ',
      'ðŸ¦Ž',
      'ðŸ¦–',
      'ðŸ¦•',
      'ðŸ™',
      'ðŸ¦‘',
      'ðŸ¦',
      'ðŸ¦ž',
      'ðŸ¦€',
      'ðŸ¡',
      'ðŸ ',
      'ðŸŸ',
      'ðŸ¬',
      'ðŸ³',
      'ðŸ‹',
      'ðŸ¦ˆ',
      'ðŸŠ',
      'ðŸ…',
      'ðŸ†',
      'ðŸ¦“',
      'ðŸ¦',
      'ðŸ¦§',
      'ðŸ˜',
      'ðŸ¦›',
      'ðŸ¦',
      'ðŸª',
      'ðŸ«',
      'ðŸ¦’',
      'ðŸ¦˜',
      'ðŸƒ',
      'ðŸ‚',
      'ðŸ„',
      'ðŸŽ',
      'ðŸ–',
      'ðŸ',
      'ðŸ‘',
      'ðŸ¦™',
      'ðŸ',
      'ðŸ¦Œ',
      'ðŸ•',
      'ðŸ©',
      'ðŸ¦®',
      'ðŸ•â€ðŸ¦º',
      'ðŸˆ',
      'ðŸ“',
      'ðŸ¦ƒ',
      'ðŸ¦š',
      'ðŸ¦œ',
      'ðŸ¦¢',
      'ðŸ¦©',
      'ðŸ•Šï¸',
      'ðŸ‡',
      'ðŸ¦',
      'ðŸ¦¨',
    ],
  },
  {
    id: 'food',
    name: 'Food & Drink',
    icon: Coffee,
    emojis: [
      'ðŸŽ',
      'ðŸ',
      'ðŸŠ',
      'ðŸ‹',
      'ðŸŒ',
      'ðŸ‰',
      'ðŸ‡',
      'ðŸ“',
      'ðŸ«',
      'ðŸˆ',
      'ðŸ’',
      'ðŸ‘',
      'ðŸ¥­',
      'ðŸ',
      'ðŸ¥¥',
      'ðŸ¥',
      'ðŸ…',
      'ðŸ†',
      'ðŸ¥‘',
      'ðŸ¥¦',
      'ðŸ¥¬',
      'ðŸ¥’',
      'ðŸŒ¶ï¸',
      'ðŸ«‘',
      'ðŸŒ½',
      'ðŸ¥•',
      'ðŸ«’',
      'ðŸ§„',
      'ðŸ§…',
      'ðŸ¥”',
      'ðŸ ',
      'ðŸ¥',
      'ðŸ¥–',
      'ðŸž',
      'ðŸ¥¨',
      'ðŸ¥¯',
      'ðŸ§€',
      'ðŸ¥š',
      'ðŸ³',
      'ðŸ§ˆ',
      'ðŸ¥ž',
      'ðŸ§‡',
      'ðŸ¥“',
      'ðŸ¥©',
      'ðŸ—',
      'ðŸ–',
      'ðŸ¦´',
      'ðŸŒ­',
      'ðŸ”',
      'ðŸŸ',
      'ðŸ•',
      'ðŸ¥ª',
      'ðŸ¥™',
      'ðŸ§†',
      'ðŸŒ®',
      'ðŸŒ¯',
      'ðŸ«”',
      'ðŸ¥—',
      'ðŸ¥˜',
      'ðŸ«•',
      'ðŸ',
      'ðŸœ',
      'ðŸ²',
      'ðŸ›',
      'ðŸ£',
      'ðŸ±',
      'ðŸ¥Ÿ',
      'ðŸ¦ª',
      'ðŸ¤',
      'ðŸ™',
      'ðŸš',
      'ðŸ˜',
      'ðŸ¥',
      'ðŸ¥ ',
      'ðŸ¥®',
      'ðŸ¢',
      'ðŸ¡',
      'ðŸ§',
      'ðŸ¨',
      'ðŸ¦',
      'ðŸ¥§',
      'ðŸ§',
      'ðŸ°',
      'ðŸŽ‚',
      'ðŸ®',
      'ðŸ­',
      'ðŸ¬',
      'ðŸ«',
      'ðŸ¿',
      'ðŸ©',
      'ðŸª',
      'ðŸŒ°',
      'ðŸ¥œ',
      'ðŸ¯',
      'ðŸ¥›',
      'ðŸ¼',
      'â˜•',
      'ðŸ«–',
      'ðŸµ',
      'ðŸ§ƒ',
    ],
  },
  {
    id: 'activity',
    name: 'Activity',
    icon: Gamepad2,
    emojis: [
      'âš½',
      'ðŸ€',
      'ðŸˆ',
      'âš¾',
      'ðŸ¥Ž',
      'ðŸŽ¾',
      'ðŸ',
      'ðŸ‰',
      'ðŸ¥',
      'ðŸŽ±',
      'ðŸª€',
      'ðŸ“',
      'ðŸ¸',
      'ðŸ’',
      'ðŸ‘',
      'ðŸ¥',
      'ðŸ',
      'ðŸªƒ',
      'ðŸ¥…',
      'â›³',
      'ðŸª',
      'ðŸ¹',
      'ðŸŽ£',
      'ðŸ¤¿',
      'ðŸ¥Š',
      'ðŸ¥‹',
      'ðŸŽ½',
      'ðŸ›¹',
      'ðŸ›·',
      'â›¸ï¸',
      'ðŸ¥Œ',
      'ðŸŽ¿',
      'â›·ï¸',
      'ðŸ‚',
      'ðŸª‚',
      'ðŸ‹ï¸â€â™€ï¸',
      'ðŸ‹ï¸',
      'ðŸ‹ï¸â€â™‚ï¸',
      'ðŸ¤¼â€â™€ï¸',
      'ðŸ¤¼',
      'ðŸ¤¼â€â™‚ï¸',
      'ðŸ¤¸â€â™€ï¸',
      'ðŸ¤¸',
      'ðŸ¤¸â€â™‚ï¸',
      'â›¹ï¸â€â™€ï¸',
      'â›¹ï¸',
      'â›¹ï¸â€â™‚ï¸',
      'ðŸ¤º',
      'ðŸ¤¾â€â™€ï¸',
      'ðŸ¤¾',
      'ðŸ¤¾â€â™‚ï¸',
      'ðŸŒï¸â€â™€ï¸',
      'ðŸŒï¸',
      'ðŸŒï¸â€â™‚ï¸',
      'ðŸ‡',
      'ðŸ§˜â€â™€ï¸',
      'ðŸ§˜',
      'ðŸ§˜â€â™‚ï¸',
      'ðŸ„â€â™€ï¸',
      'ðŸ„',
      'ðŸ„â€â™‚ï¸',
      'ðŸŠâ€â™€ï¸',
      'ðŸŠ',
      'ðŸŠâ€â™‚ï¸',
      'ðŸ¤½â€â™€ï¸',
      'ðŸ¤½',
      'ðŸ¤½â€â™‚ï¸',
      'ðŸš£â€â™€ï¸',
      'ðŸš£',
      'ðŸš£â€â™‚ï¸',
      'ðŸ§—â€â™€ï¸',
      'ðŸ§—',
      'ðŸ§—â€â™‚ï¸',
      'ðŸšµâ€â™€ï¸',
      'ðŸšµ',
      'ðŸšµâ€â™‚ï¸',
      'ðŸš´â€â™€ï¸',
      'ðŸš´',
      'ðŸš´â€â™‚ï¸',
      'ðŸ†',
      'ðŸ¥‡',
      'ðŸ¥ˆ',
      'ðŸ¥‰',
      'ðŸ…',
      'ðŸŽ–ï¸',
      'ðŸµï¸',
      'ðŸŽ—ï¸',
      'ðŸŽ«',
      'ðŸŽŸï¸',
      'ðŸŽª',
      'ðŸ¤¹',
      'ðŸ¤¹â€â™‚ï¸',
      'ðŸ¤¹â€â™€ï¸',
      'ðŸŽ­',
      'ðŸ©°',
      'ðŸŽ¨',
      'ðŸŽ¬',
      'ðŸŽ¤',
      'ðŸŽ§',
      'ðŸŽ¼',
    ],
  },
  {
    id: 'travel',
    name: 'Travel & Places',
    icon: Car,
    emojis: [
      'ðŸš—',
      'ðŸš•',
      'ðŸš™',
      'ðŸšŒ',
      'ðŸšŽ',
      'ðŸŽï¸',
      'ðŸš“',
      'ðŸš‘',
      'ðŸš’',
      'ðŸš',
      'ðŸ›»',
      'ðŸšš',
      'ðŸš›',
      'ðŸšœ',
      'ðŸï¸',
      'ðŸ›µ',
      'ðŸš²',
      'ðŸ›´',
      'ðŸ›¹',
      'ðŸ›¼',
      'ðŸš',
      'ðŸ›¸',
      'âœˆï¸',
      'ðŸ›©ï¸',
      'ðŸ›«',
      'ðŸ›¬',
      'ðŸª‚',
      'ðŸ’º',
      'ðŸš€',
      'ðŸ›°ï¸',
      'ðŸšŠ',
      'ðŸš',
      'ðŸš„',
      'ðŸš…',
      'ðŸšˆ',
      'ðŸš‚',
      'ðŸš†',
      'ðŸš‡',
      'ðŸš‰',
      'ðŸšž',
      'ðŸš‹',
      'ðŸšƒ',
      'ðŸš–',
      'ðŸš˜',
      'ðŸš',
      'ðŸš”',
      'ðŸš¨',
      'ðŸš“',
      'ðŸš’',
      'ðŸš‘',
      'â›‘ï¸',
      'ðŸ›£ï¸',
      'ðŸ›¤ï¸',
      'ðŸ›¢ï¸',
      'â›½',
      'ðŸš',
      'ðŸš¥',
      'ðŸš¦',
      'ðŸ›‘',
      'ðŸš§',
      'âš“',
      'â›µ',
      'ðŸ›¶',
      'ðŸš¤',
      'ðŸ›³ï¸',
      'â›´ï¸',
      'ðŸ›¥ï¸',
      'ðŸš¢',
      'âœˆï¸',
      'ðŸ›©ï¸',
      'ðŸ›«',
      'ðŸ›¬',
      'ðŸ’º',
      'ðŸš',
      'ðŸšŸ',
      'ðŸš ',
      'ðŸš¡',
      'ðŸ›°ï¸',
      'ðŸš€',
      'ðŸ›¸',
      'ðŸ ',
      'ðŸ¡',
      'ðŸ˜ï¸',
      'ðŸšï¸',
      'ðŸ—ï¸',
      'ðŸ­',
      'ðŸ¢',
      'ðŸ¬',
      'ðŸ£',
      'ðŸ¤',
      'ðŸ¥',
      'ðŸ¦',
      'ðŸ¨',
      'ðŸª',
      'ðŸ«',
      'ðŸ©',
      'ðŸ’’',
      'ðŸ›ï¸',
      'â›ª',
      'ðŸ•Œ',
    ],
  },
  {
    id: 'objects',
    name: 'Objects',
    icon: Zap,
    emojis: [
      'âŒš',
      'ðŸ“±',
      'ðŸ“²',
      'ðŸ’»',
      'âŒ¨ï¸',
      'ðŸ–¥ï¸',
      'ðŸ–¨ï¸',
      'ðŸ–±ï¸',
      'ðŸ–²ï¸',
      'ðŸ•¹ï¸',
      'ðŸ—œï¸',
      'ðŸ’½',
      'ðŸ’¾',
      'ðŸ’¿',
      'ðŸ“€',
      'ðŸ“¼',
      'ðŸ“·',
      'ðŸ“¸',
      'ðŸ“¹',
      'ðŸŽ¥',
      'ðŸ“½ï¸',
      'ðŸŽžï¸',
      'ðŸ“ž',
      'â˜Žï¸',
      'ðŸ“Ÿ',
      'ðŸ“ ',
      'ðŸ“º',
      'ðŸ“»',
      'ðŸŽ™ï¸',
      'ðŸŽšï¸',
      'ðŸŽ›ï¸',
      'ðŸ§­',
      'â±ï¸',
      'â²ï¸',
      'â°',
      'ðŸ•°ï¸',
      'âŒ›',
      'â³',
      'ðŸ“¡',
      'ðŸ”‹',
      'ðŸ”Œ',
      'ðŸ’¡',
      'ðŸ”¦',
      'ðŸ•¯ï¸',
      'ðŸª”',
      'ðŸ§¯',
      'ðŸ›¢ï¸',
      'ðŸ’¸',
      'ðŸ’µ',
      'ðŸ’´',
      'ðŸ’¶',
      'ðŸ’·',
      'ðŸ’°',
      'ðŸ’³',
      'ðŸ’Ž',
      'âš–ï¸',
      'ðŸ§°',
      'ðŸ”§',
      'ðŸ”¨',
      'âš’ï¸',
      'ðŸ› ï¸',
      'â›ï¸',
      'ðŸ”©',
      'âš™ï¸',
      'ðŸ§±',
      'â›“ï¸',
      'ðŸ§²',
      'ðŸ”«',
      'ðŸ’£',
      'ðŸ§¨',
      'ðŸª“',
      'ðŸ”ª',
      'ðŸ—¡ï¸',
      'âš”ï¸',
      'ðŸ›¡ï¸',
      'ðŸš¬',
      'âš°ï¸',
      'âš±ï¸',
      'ðŸº',
      'ðŸ”®',
      'ðŸ“¿',
      'ðŸ§¿',
      'ðŸ’ˆ',
      'âš—ï¸',
      'ðŸ”­',
      'ðŸ”¬',
      'ðŸ•³ï¸',
      'ðŸ©¹',
      'ðŸ©º',
      'ðŸ’Š',
      'ðŸ’‰',
      'ðŸ§¬',
      'ðŸ¦ ',
      'ðŸ§«',
      'ðŸ§ª',
      'ðŸŒ¡ï¸',
      'ðŸ§¹',
      'ðŸ§º',
      'ðŸ§»',
      'ðŸš½',
    ],
  },
  {
    id: 'symbols',
    name: 'Symbols',
    icon: Star,
    emojis: [
      'â¤ï¸',
      'ðŸ§¡',
      'ðŸ’›',
      'ðŸ’š',
      'ðŸ’™',
      'ðŸ’œ',
      'ðŸ–¤',
      'ðŸ¤',
      'ðŸ¤Ž',
      'ðŸ’”',
      'â£ï¸',
      'ðŸ’•',
      'ðŸ’ž',
      'ðŸ’“',
      'ðŸ’—',
      'ðŸ’–',
      'ðŸ’˜',
      'ðŸ’',
      'ðŸ’Ÿ',
      'â˜®ï¸',
      'âœï¸',
      'â˜ªï¸',
      'ðŸ•‰ï¸',
      'â˜¸ï¸',
      'âœ¡ï¸',
      'ðŸ”¯',
      'ðŸ•Ž',
      'â˜¯ï¸',
      'â˜¦ï¸',
      'ðŸ›',
      'â›Ž',
      'â™ˆ',
      'â™‰',
      'â™Š',
      'â™‹',
      'â™Œ',
      'â™',
      'â™Ž',
      'â™',
      'â™',
      'â™‘',
      'â™’',
      'â™“',
      'ðŸ†”',
      'âš›ï¸',
      'ðŸ‰‘',
      'â˜¢ï¸',
      'â˜£ï¸',
      'ðŸ“´',
      'ðŸ“³',
      'ðŸˆ¶',
      'ðŸˆš',
      'ðŸˆ¸',
      'ðŸˆº',
      'ðŸˆ·ï¸',
      'âœ´ï¸',
      'ðŸ†š',
      'ðŸ’®',
      'ðŸ‰',
      'ãŠ™ï¸',
      'ãŠ—ï¸',
      'ðŸˆ´',
      'ðŸˆµ',
      'ðŸˆ¹',
      'ðŸˆ²',
      'ðŸ…°ï¸',
      'ðŸ…±ï¸',
      'ðŸ†Ž',
      'ðŸ†‘',
      'ðŸ…¾ï¸',
      'ðŸ†˜',
      'âŒ',
      'â­•',
      'ðŸ›‘',
      'â›”',
      'ðŸ“›',
      'ðŸš«',
      'ðŸ’¯',
      'ðŸ’¢',
      'â™¨ï¸',
      'ðŸš·',
      'ðŸš¯',
      'ðŸš³',
      'ðŸš±',
      'ðŸ”ž',
      'ðŸ“µ',
      'ðŸš­',
      'â—',
      'â•',
      'â“',
      'â”',
      'â€¼ï¸',
      'â‰ï¸',
      'ðŸ”…',
      'ðŸ”†',
      'ã€½ï¸',
      'âš ï¸',
      'ðŸš¸',
      'ðŸ”±',
      'âšœï¸',
    ],
  },
  {
    id: 'flags',
    name: 'Flags',
    icon: Flag,
    emojis: [
      'ðŸ',
      'ðŸš©',
      'ðŸŽŒ',
      'ðŸ´',
      'ðŸ³ï¸',
      'ðŸ³ï¸â€ðŸŒˆ',
      'ðŸ³ï¸â€âš§ï¸',
      'ðŸ´â€â˜ ï¸',
      'ðŸ‡¦ðŸ‡¨',
      'ðŸ‡¦ðŸ‡©',
      'ðŸ‡¦ðŸ‡ª',
      'ðŸ‡¦ðŸ‡«',
      'ðŸ‡¦ðŸ‡¬',
      'ðŸ‡¦ðŸ‡®',
      'ðŸ‡¦ðŸ‡±',
      'ðŸ‡¦ðŸ‡²',
      'ðŸ‡¦ðŸ‡´',
      'ðŸ‡¦ðŸ‡¶',
      'ðŸ‡¦ðŸ‡·',
      'ðŸ‡¦ðŸ‡¸',
      'ðŸ‡¦ðŸ‡¹',
      'ðŸ‡¦ðŸ‡º',
      'ðŸ‡¦ðŸ‡¼',
      'ðŸ‡¦ðŸ‡½',
      'ðŸ‡¦ðŸ‡¿',
      'ðŸ‡§ðŸ‡¦',
      'ðŸ‡§ðŸ‡§',
      'ðŸ‡§ðŸ‡©',
      'ðŸ‡§ðŸ‡ª',
      'ðŸ‡§ðŸ‡«',
      'ðŸ‡§ðŸ‡¬',
      'ðŸ‡§ðŸ‡­',
      'ðŸ‡§ðŸ‡®',
      'ðŸ‡§ðŸ‡¯',
      'ðŸ‡§ðŸ‡±',
      'ðŸ‡§ðŸ‡²',
      'ðŸ‡§ðŸ‡³',
      'ðŸ‡§ðŸ‡´',
      'ðŸ‡§ðŸ‡¶',
      'ðŸ‡§ðŸ‡·',
      'ðŸ‡§ðŸ‡¸',
      'ðŸ‡§ðŸ‡¹',
      'ðŸ‡§ðŸ‡»',
      'ðŸ‡§ðŸ‡¼',
      'ðŸ‡§ðŸ‡¾',
      'ðŸ‡§ðŸ‡¿',
      'ðŸ‡¨ðŸ‡¦',
      'ðŸ‡¨ðŸ‡¨',
      'ðŸ‡¨ðŸ‡©',
      'ðŸ‡¨ðŸ‡«',
      'ðŸ‡¨ðŸ‡¬',
      'ðŸ‡¨ðŸ‡­',
      'ðŸ‡¨ðŸ‡®',
      'ðŸ‡¨ðŸ‡°',
      'ðŸ‡¨ðŸ‡±',
      'ðŸ‡¨ðŸ‡²',
      'ðŸ‡¨ðŸ‡³',
      'ðŸ‡¨ðŸ‡´',
      'ðŸ‡¨ðŸ‡µ',
      'ðŸ‡¨ðŸ‡·',
      'ðŸ‡¨ðŸ‡º',
      'ðŸ‡¨ðŸ‡»',
      'ðŸ‡¨ðŸ‡¼',
      'ðŸ‡¨ðŸ‡½',
      'ðŸ‡¨ðŸ‡¾',
      'ðŸ‡¨ðŸ‡¿',
      'ðŸ‡©ðŸ‡ª',
      'ðŸ‡©ðŸ‡¬',
      'ðŸ‡©ðŸ‡¯',
      'ðŸ‡©ðŸ‡°',
      'ðŸ‡©ðŸ‡²',
      'ðŸ‡©ðŸ‡´',
      'ðŸ‡©ðŸ‡¿',
      'ðŸ‡ªðŸ‡¦',
      'ðŸ‡ªðŸ‡¨',
      'ðŸ‡ªðŸ‡ª',
      'ðŸ‡ªðŸ‡¬',
      'ðŸ‡ªðŸ‡­',
      'ðŸ‡ªðŸ‡·',
      'ðŸ‡ªðŸ‡¸',
      'ðŸ‡ªðŸ‡¹',
      'ðŸ‡ªðŸ‡º',
      'ðŸ‡«ðŸ‡®',
      'ðŸ‡«ðŸ‡¯',
      'ðŸ‡«ðŸ‡°',
      'ðŸ‡«ðŸ‡²',
      'ðŸ‡«ðŸ‡´',
      'ðŸ‡«ðŸ‡·',
      'ðŸ‡¬ðŸ‡¦',
      'ðŸ‡¬ðŸ‡§',
      'ðŸ‡¬ðŸ‡©',
      'ðŸ‡¬ðŸ‡ª',
      'ðŸ‡¬ðŸ‡«',
      'ðŸ‡¬ðŸ‡¬',
      'ðŸ‡¬ðŸ‡­',
      'ðŸ‡¬ðŸ‡®',
      'ðŸ‡¬ðŸ‡±',
      'ðŸ‡¬ðŸ‡²',
      'ðŸ‡¬ðŸ‡³',
      'ðŸ‡¬ðŸ‡µ',
      'ðŸ‡¬ðŸ‡¶',
      'ðŸ‡¬ðŸ‡·',
      'ðŸ‡¬ðŸ‡¸',
      'ðŸ‡¬ðŸ‡¹',
      'ðŸ‡¬ðŸ‡º',
      'ðŸ‡¬ðŸ‡¼',
      'ðŸ‡¬ðŸ‡¾',
      'ðŸ‡­ðŸ‡°',
      'ðŸ‡­ðŸ‡²',
      'ðŸ‡­ðŸ‡³',
      'ðŸ‡­ðŸ‡·',
      'ðŸ‡­ðŸ‡¹',
      'ðŸ‡­ðŸ‡º',
      'ðŸ‡®ðŸ‡¨',
      'ðŸ‡®ðŸ‡©',
      'ðŸ‡®ðŸ‡ª',
      'ðŸ‡®ðŸ‡±',
      'ðŸ‡®ðŸ‡²',
      'ðŸ‡®ðŸ‡³',
      'ðŸ‡®ðŸ‡´',
      'ðŸ‡®ðŸ‡¶',
      'ðŸ‡®ðŸ‡·',
      'ðŸ‡®ðŸ‡¸',
      'ðŸ‡®ðŸ‡¹',
      'ðŸ‡¯ðŸ‡ª',
      'ðŸ‡¯ðŸ‡²',
      'ðŸ‡¯ðŸ‡´',
      'ðŸ‡¯ðŸ‡µ',
      'ðŸ‡°ðŸ‡ª',
      'ðŸ‡°ðŸ‡¬',
      'ðŸ‡°ðŸ‡­',
      'ðŸ‡°ðŸ‡®',
      'ðŸ‡°ðŸ‡²',
      'ðŸ‡°ðŸ‡³',
      'ðŸ‡°ðŸ‡µ',
      'ðŸ‡°ðŸ‡·',
      'ðŸ‡°ðŸ‡¼',
      'ðŸ‡°ðŸ‡¾',
      'ðŸ‡°ðŸ‡¿',
      'ðŸ‡±ðŸ‡¦',
      'ðŸ‡±ðŸ‡§',
      'ðŸ‡±ðŸ‡¨',
      'ðŸ‡±ðŸ‡®',
      'ðŸ‡±ðŸ‡°',
      'ðŸ‡±ðŸ‡·',
      'ðŸ‡±ðŸ‡¸',
      'ðŸ‡±ðŸ‡¹',
      'ðŸ‡±ðŸ‡º',
      'ðŸ‡±ðŸ‡»',
      'ðŸ‡±ðŸ‡¾',
      'ðŸ‡²ðŸ‡¦',
      'ðŸ‡²ðŸ‡¨',
      'ðŸ‡²ðŸ‡©',
      'ðŸ‡²ðŸ‡ª',
      'ðŸ‡²ðŸ‡«',
      'ðŸ‡²ðŸ‡¬',
      'ðŸ‡²ðŸ‡­',
      'ðŸ‡²ðŸ‡°',
      'ðŸ‡²ðŸ‡±',
      'ðŸ‡²ðŸ‡²',
      'ðŸ‡²ðŸ‡³',
      'ðŸ‡²ðŸ‡´',
      'ðŸ‡²ðŸ‡µ',
      'ðŸ‡²ðŸ‡¶',
      'ðŸ‡²ðŸ‡·',
      'ðŸ‡²ðŸ‡¸',
      'ðŸ‡²ðŸ‡¹',
      'ðŸ‡²ðŸ‡º',
      'ðŸ‡²ðŸ‡»',
      'ðŸ‡²ðŸ‡¼',
      'ðŸ‡²ðŸ‡½',
      'ðŸ‡²ðŸ‡¾',
      'ðŸ‡²ðŸ‡¿',
      'ðŸ‡³ðŸ‡¦',
      'ðŸ‡³ðŸ‡¨',
      'ðŸ‡³ðŸ‡ª',
      'ðŸ‡³ðŸ‡«',
      'ðŸ‡³ðŸ‡¬',
      'ðŸ‡³ðŸ‡®',
      'ðŸ‡³ðŸ‡±',
      'ðŸ‡³ðŸ‡´',
      'ðŸ‡³ðŸ‡µ',
      'ðŸ‡³ðŸ‡·',
      'ðŸ‡³ðŸ‡º',
      'ðŸ‡³ðŸ‡¿',
      'ðŸ‡´ðŸ‡²',
      'ðŸ‡µðŸ‡¦',
      'ðŸ‡µðŸ‡ª',
      'ðŸ‡µðŸ‡«',
      'ðŸ‡µðŸ‡¬',
      'ðŸ‡µðŸ‡­',
      'ðŸ‡µðŸ‡°',
      'ðŸ‡µðŸ‡±',
      'ðŸ‡µðŸ‡²',
      'ðŸ‡µðŸ‡³',
      'ðŸ‡µðŸ‡·',
      'ðŸ‡µðŸ‡¸',
      'ðŸ‡µðŸ‡¹',
      'ðŸ‡µðŸ‡¼',
      'ðŸ‡µðŸ‡¾',
      'ðŸ‡¶ðŸ‡¦',
      'ðŸ‡·ðŸ‡ª',
      'ðŸ‡·ðŸ‡´',
      'ðŸ‡·ðŸ‡¸',
      'ðŸ‡·ðŸ‡º',
      'ðŸ‡·ðŸ‡¼',
      'ðŸ‡¸ðŸ‡¦',
      'ðŸ‡¸ðŸ‡§',
      'ðŸ‡¸ðŸ‡¨',
      'ðŸ‡¸ðŸ‡©',
      'ðŸ‡¸ðŸ‡ª',
      'ðŸ‡¸ðŸ‡¬',
      'ðŸ‡¸ðŸ‡­',
      'ðŸ‡¸ðŸ‡®',
      'ðŸ‡¸ðŸ‡¯',
      'ðŸ‡¸ðŸ‡°',
      'ðŸ‡¸ðŸ‡±',
      'ðŸ‡¸ðŸ‡²',
      'ðŸ‡¸ðŸ‡³',
      'ðŸ‡¸ðŸ‡´',
      'ðŸ‡¸ðŸ‡·',
      'ðŸ‡¸ðŸ‡¸',
      'ðŸ‡¸ðŸ‡¹',
      'ðŸ‡¸ðŸ‡»',
      'ðŸ‡¸ðŸ‡½',
      'ðŸ‡¸ðŸ‡¾',
      'ðŸ‡¸ðŸ‡¿',
      'ðŸ‡¹ðŸ‡¦',
      'ðŸ‡¹ðŸ‡¨',
      'ðŸ‡¹ðŸ‡©',
      'ðŸ‡¹ðŸ‡«',
      'ðŸ‡¹ðŸ‡¬',
      'ðŸ‡¹ðŸ‡­',
      'ðŸ‡¹ðŸ‡¯',
      'ðŸ‡¹ðŸ‡°',
      'ðŸ‡¹ðŸ‡±',
      'ðŸ‡¹ðŸ‡²',
      'ðŸ‡¹ðŸ‡³',
      'ðŸ‡¹ðŸ‡´',
      'ðŸ‡¹ðŸ‡·',
      'ðŸ‡¹ðŸ‡¹',
      'ðŸ‡¹ðŸ‡»',
      'ðŸ‡¹ðŸ‡¼',
      'ðŸ‡¹ðŸ‡¿',
      'ðŸ‡ºðŸ‡¦',
      'ðŸ‡ºðŸ‡¬',
      'ðŸ‡ºðŸ‡²',
      'ðŸ‡ºðŸ‡³',
      'ðŸ‡ºðŸ‡¸',
      'ðŸ‡ºðŸ‡¾',
      'ðŸ‡ºðŸ‡¿',
      'ðŸ‡»ðŸ‡¦',
      'ðŸ‡»ðŸ‡¨',
      'ðŸ‡»ðŸ‡ª',
      'ðŸ‡»ðŸ‡¬',
      'ðŸ‡»ðŸ‡®',
      'ðŸ‡»ðŸ‡³',
      'ðŸ‡»ðŸ‡º',
      'ðŸ‡¼ðŸ‡«',
      'ðŸ‡¼ðŸ‡¸',
      'ðŸ‡½ðŸ‡°',
      'ðŸ‡¾ðŸ‡ª',
      'ðŸ‡¾ðŸ‡¹',
      'ðŸ‡¿ðŸ‡¦',
      'ðŸ‡¿ðŸ‡²',
      'ðŸ‡¿ðŸ‡¼',
    ],
  },
];

export function EmojiPicker({ onEmojiSelect, className }: EmojiPickerProps) {
  const [searchTerm, setSearchTerm] = useState('');
  const [activeCategory, setActiveCategory] = useState('recent');

  // Get recent emojis from localStorage
  const getRecentEmojis = (): string[] => {
    if (typeof window === 'undefined') return [];
    try {
      const recent = localStorage.getItem('recent-emojis');
      return recent ? JSON.parse(recent) : [];
    } catch {
      return [];
    }
  };

  // Save emoji to recent
  const saveRecentEmoji = (emoji: string) => {
    if (typeof window === 'undefined') return;
    try {
      const recent = getRecentEmojis();
      const updated = [emoji, ...recent.filter(e => e !== emoji)].slice(0, 24);
      localStorage.setItem('recent-emojis', JSON.stringify(updated));
    } catch {
      // Ignore errors
    }
  };

  // Update recent category with actual data
  const categoriesWithRecent = useMemo(() => {
    const recentEmojis = getRecentEmojis();
    return EMOJI_CATEGORIES.map(category =>
      category.id === 'recent'
        ? { ...category, emojis: recentEmojis }
        : category
    );
  }, []);

  // Filter emojis based on search
  const filteredEmojis = useMemo(() => {
    if (!searchTerm) return [];

    const searchLower = searchTerm.toLowerCase();
    const allEmojis = EMOJI_CATEGORIES.flatMap(cat => cat.emojis);

    // Simple emoji search - in a real app you'd have emoji names/keywords
    const emojiKeywords: Record<string, string[]> = {
      'ðŸ˜€': ['smile', 'happy', 'grin'],
      'ðŸ˜‚': ['laugh', 'funny', 'joy', 'tears'],
      'â¤ï¸': ['love', 'heart', 'red'],
      'ðŸ‘': ['like', 'thumbs', 'up', 'good'],
      'ðŸ‘Ž': ['dislike', 'thumbs', 'down', 'bad'],
      'ðŸ”¥': ['fire', 'hot', 'flame', 'lit'],
      'ðŸ’¯': ['hundred', 'perfect', 'score'],
      'ðŸŽ‰': ['party', 'celebration', 'confetti'],
      'ðŸ¥³': ['party', 'celebration', 'hat'],
      'ðŸ˜­': ['cry', 'sad', 'tears'],
      'ðŸ˜': ['love', 'heart', 'eyes'],
      'ðŸ¤”': ['thinking', 'hmm', 'wonder'],
      'ðŸ‘€': ['eyes', 'looking', 'watching'],
      'ðŸ™': ['pray', 'please', 'thanks'],
      'ðŸ’ª': ['strong', 'muscle', 'power'],
      'âœ¨': ['sparkle', 'magic', 'shine'],
      'ðŸŒŸ': ['star', 'sparkle', 'shine'],
      'â­': ['star', 'favorite'],
      'ðŸŽ¯': ['target', 'goal', 'aim'],
      'ðŸš€': ['rocket', 'fast', 'launch'],
    };

    return allEmojis.filter(emoji => {
      const keywords = emojiKeywords[emoji] || [];
      return keywords.some(keyword => keyword.includes(searchLower));
    });
  }, [searchTerm]);

  const handleEmojiClick = (emoji: string) => {
    saveRecentEmoji(emoji);
    onEmojiSelect(emoji);
  };

  const currentEmojis = searchTerm
    ? filteredEmojis
    : categoriesWithRecent.find(cat => cat.id === activeCategory)?.emojis || [];

  return (
    <div
      className={cn(
        'h-96 w-80 rounded-lg border bg-white shadow-lg',
        className
      )}
    >
      {/* Search */}
      <div className="border-b p-3">
        <div className="relative">
          <Search className="absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 transform text-gray-400" />
          <Input
            placeholder="Search emojis..."
            value={searchTerm}
            onChange={e => setSearchTerm(e.target.value)}
            className="h-8 pl-9"
          />
        </div>
      </div>

      {/* Category Tabs */}
      {!searchTerm && (
        <Tabs
          value={activeCategory}
          onValueChange={setActiveCategory}
          className="flex h-full flex-col"
        >
          <TabsList className="grid h-auto grid-cols-8 gap-1 bg-gray-50 p-2">
            {categoriesWithRecent.map(category => {
              const Icon = category.icon;
              return (
                <TabsTrigger
                  key={category.id}
                  value={category.id}
                  className="p-2 data-[state=active]:bg-white data-[state=active]:shadow-sm"
                  title={category.name}
                >
                  <Icon className="h-4 w-4" />
                </TabsTrigger>
              );
            })}
          </TabsList>

          {/* Emoji Grid */}
          <div className="flex-1 overflow-hidden">
            {categoriesWithRecent.map(category => (
              <TabsContent
                key={category.id}
                value={category.id}
                className="m-0 h-full p-0"
              >
                <ScrollArea className="h-full">
                  {category.emojis.length === 0 ? (
                    <div className="flex h-32 flex-col items-center justify-center text-gray-500">
                      <Icon className="mb-2 h-8 w-8" />
                      <p className="text-sm">
                        {category.id === 'recent'
                          ? 'No recent emojis'
                          : 'No emojis in this category'}
                      </p>
                    </div>
                  ) : (
                    <div className="grid grid-cols-8 gap-1 p-2">
                      {category.emojis.map((emoji, index) => (
                        <Button
                          key={`${emoji}-${index}`}
                          variant="ghost"
                          className="h-8 w-8 rounded p-0 text-lg hover:bg-gray-100"
                          onClick={() => handleEmojiClick(emoji)}
                          title={emoji}
                        >
                          {emoji}
                        </Button>
                      ))}
                    </div>
                  )}
                </ScrollArea>
              </TabsContent>
            ))}
          </div>
        </Tabs>
      )}

      {/* Search Results */}
      {searchTerm && (
        <ScrollArea className="h-80">
          {filteredEmojis.length === 0 ? (
            <div className="flex h-32 flex-col items-center justify-center text-gray-500">
              <Search className="mb-2 h-8 w-8" />
              <p className="text-sm">No emojis found</p>
              <p className="text-xs text-gray-400">Try different keywords</p>
            </div>
          ) : (
            <div className="grid grid-cols-8 gap-1 p-2">
              {filteredEmojis.map((emoji, index) => (
                <Button
                  key={`${emoji}-${index}`}
                  variant="ghost"
                  className="h-8 w-8 rounded p-0 text-lg hover:bg-gray-100"
                  onClick={() => handleEmojiClick(emoji)}
                  title={emoji}
                >
                  {emoji}
                </Button>
              ))}
            </div>
          )}
        </ScrollArea>
      )}

      {/* Footer with quick emojis */}
      {!searchTerm && (
        <div className="border-t bg-gray-50 p-2">
          <div className="flex justify-center space-x-1">
            {['ðŸ‘', 'ðŸ‘Ž', 'â¤ï¸', 'ðŸ˜‚', 'ðŸ˜®', 'ðŸ˜¢', 'ðŸ˜¡', 'ðŸ”¥'].map(emoji => (
              <Button
                key={emoji}
                variant="ghost"
                className="h-8 w-8 rounded p-0 text-base hover:bg-gray-200"
                onClick={() => handleEmojiClick(emoji)}
                title={`Quick: ${emoji}`}
              >
                {emoji}
              </Button>
            ))}
          </div>
        </div>
      )}
    </div>
  );
}
